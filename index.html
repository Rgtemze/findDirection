<!--FIND DIRECTION-->
<!DOCTYPE html>
<html>
<head>
  <title>Find Direction</title>
  <style>
  /* Always set the map height explicitly to define the size of the div
   * element that contains the map. */
  #map {
    height: 100%;
  }
  /* Optional: Makes the sample page fill the window. */
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
  }
</style>
</head>
<body onLoad = "getLocation()">
  <script>
    var current = null;
    var previous = null;
    var map;
    var flightPath;
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(trackLocation);
        } else {
            console.log("Geolocation is not supported by this browser.");
        }
    }
    function trackLocation(pos){
      var lat = pos.coords.latitude;
      var lng = pos.coords.longitude;
      if(!current && !previous){

        current = previous = [lat,lng]
        map.setCenter({lat: current[0], lng:current[1]});

      }else{
        current = [lat,lng]
        console.log('current is ', current, 'but previous was ', previous)
        if(current[0] != previous[0] || current[1] != previous[1]){
          var res = findSlopeandRadian(current,previous)
          console.log(res[1]);
          console.log('slope is ', res[0], ' degree is ',(Math.PI/2.0 - res[1])*180/Math.PI, 'degree')
        }
        flightPath.setPath([{lat: previous[0],lng: previous[1]},{lat: current[0] ,lng: current[1]}])
        previous = current

      }
    }
    function findSlopeandRadian(current,previous){
      var slope = (current[1] - previous[1]) / (current[0] - previous[0])
      var radian = Math.atan(slope)
      return [slope,radian]

    }
  </script>
  <div id="map"></div>
  <script>

    function initMap() {
     map = new google.maps.Map(document.getElementById('map'), {
        zoom: 4,
        center: {lat: 0, lng: -180},
        mapTypeId: 'terrain'
      });
      flightPath = new google.maps.Polyline({
        path: {},
        geodesic: false,
        icons: [{
                  icon: {path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW},
                  offset: '100%',
                  repeat: '20px'
              }],
        geodesic: true,
        strokeColor: '#FF0000',
        strokeOpacity: 1.0,
        strokeWeight: 2
      });

      flightPath.setMap(map);
    }
  </script>
  <script async defer
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBM3NbeAhH1WZp727f8dfv7FMjXuG5ybAY&callback=initMap">
  </script>
</body>
</html>
